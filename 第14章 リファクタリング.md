---
tags:
  - 良いコード悪いコードで学ぶ設計入門
---
- リファクタリングの流れ
	- [[リファクタリング]]とは、外から見た挙動を変えずに、構造を整理すること
	- ネストを解消し、見通しを良くする
	- 意味のある単位にロジックをまとめる
	- 条件を読みやすくする
		- 論理否定よりメソッド追加
	- ベタ書きロジックを目的を表すメソッドに置き換える
- ユニットテストでリファクタリングのミスを防ぐ
	- リファクタリングにはユニットテストが必須
	- コードの課題を整理する
		- クラスメソッド、値オブジェクト、デザインパターンの使用、etc
	- テストコードを用いたリファクタリングの流れ（はじめから仕様がわかっている前提のアプローチ）
		1. あるべき構造の雛形クラスをある程度つくる
		2. 雛形くらすに対してテストコードを書く
		3. テストを失敗させる
		4. テストを成功させるための最低限のコードを書く
		5. 雛形クラス内部でリファクタリング対象のコードを呼び出す
		6. テストが成功するよう、あるべき構造へロジックを少しずつリファクタしていく
- あやふやな仕様を理解するための分析方法
	- 仕様分析方法１：仕様化テスト
		- 分析したいメソッドのテストを書き、どのような引数を渡すとどのような挙動を示すかを明らかにする方法
	- 仕様分析方法２：試行リファクタリング
		- ブランチを切って、テストなしで試しにリファクタしてみるとそのロジックの仕様理解が進み、リファクタリングの見通しが立つようになる。
		- 見通しが立ったら、改めてブランチを切って、ユニットテストを書いてリファクタする
- IDEのリファクタリング機能
	- リネーム
	- メソッド抽出
- リファクタリングで注意すること
	- 機能追加とリファクタリングを同時にやらない
	- スモールステップで実施する
	- 無駄な仕様は削除することも視野に
		- 仕様バグ、矛盾しているコードをリファクタリングしても、整合性の取れたコードには決して到達しない。
		- リファクタリングの前に仕様の棚卸しをし、無駄な仕様やコードをあらかじめ削除することも重要
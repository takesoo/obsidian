## what
- プログラムが例外（エラー）を発生させた場合にどう対応するか
- すべての例外をキャッチする必要はない
	- 関数が自分で解決できる場合はキャッチし、以下のいずれかで処理する
		- リトライ・代替
			- 別の方法でやり直す
			- 例：3回りトライする。別のサーバーに接続する。
		- 翻訳・ラップ
			- わかりやすい名前に変える
			- 例：`SQLException`→`UserRegistrationException
		- 終焉・記録
			- ログを記録して謝罪する
			- 例：エラーログを吐き出して、Sorryページ表示
- 例外の握りつぶしだけは絶対にしないこと
```python
try:
	process_data()
except Exception:
	pass  # 🙅‍♂️
```
### エラーの種類
- 業務エラー
	- 業務設計の中で想定されている範囲内で処理が分岐し、正常終了できなかった場合のエラーをさす。
	- ユーザーの入力値異常、権限エラー、データの状態による制御など。
	- 4xx系ステータスを返す
	- 「お前が悪い、ちゃんとやり直せ。」
- システムエラー
	- 業務設計の装丁範囲外の異常事態が発生し、処理を正常に遂行できなくなった場合のエラーをさす。
	- データ異常、データ不整合、サーバーダウン、ネットワークエラーなど。
	- 5xx系ステータスを返す
	- 「私が悪いです。何とかします。」

## how
### 思考プロセス
1. ハッピーパスを先に書く
2. 前提条件を疑う
	- もしネットワークが途切れたら？もしファイルがなかったら？
3. 関数自身に責任があるかを問う
	- その場でリトライしたり代わりの手段があるなら`try-catch`を書く

### Railsの場合
業務エラーはモデルのバリデーションで検証し、エラー内容はモデルのerrorsに格納される。処理の結果をコントローラーで判定し、失敗時の処理を用意する。
システムエラーはRailsの共通処理に任せる。ログへのエラー出力と500エラー画面表示はRailsがデフォルトでやってくれる。Sentryも設定すれば自動で通知してくれる。

---
finished reading: false
---
# OSSコードリーディングのすゝめ - Qiita
  #ReadItLater 
 #ReadableArticle

## articleURL
https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65

## siteName
Qiita

## date
2024-09-19

## articleContent
## [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB)はじめに

### [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#oss%E3%81%A8%E3%81%AF)OSSとは

簡単に言うと、誰でも無料で読んだり使ったりすることができるソースコードです。

オープンソースという言葉が生まれた1998年に、定義が定められました。  
[オープンソースの定義(v1.9)注釈付](https://opensource.jp/osd/osd19/)

まとめると、  
**・再配布自由**  
**・ソースコードの公開**  
**・派生物の許容**  
**・差別の禁止**  
**・追加ライセンスの禁止**

これらの条件を守っているものがオープンソースと呼ばれるようです。

### [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#chatgpt%E3%81%AE%E5%87%BA%E7%8F%BE)ChatGPTの出現

ChatGPTや各Pluginの活用方法がメジャーになったことで、コードリーディングに関しても今までとは比べ物にならない程、効率的に行うことができるようになりました。

## [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#%E4%BD%95%E3%81%AE%E3%81%9F%E3%82%81%E3%81%AB%E8%AA%AD%E3%82%80%E3%81%AE%E3%81%8B)何のために読むのか

OSSコードリーディングは、他人のコードを読むことで技術力を向上させる方法として知られています。  
実際にどのような良いことがあるのかをまとめました。

### [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#%E6%A5%AD%E5%8B%99%E3%81%AE%E3%81%9F%E3%82%81)業務のため

自社のシステムに組み込まれているOSSのコードを理解し, システムの安定性を保つために行います。  
OSSのコードまで理解しておくと、開発やシステムの保守、デバッグも**本質的な理解**をした上で行えるようになります。

### [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#%E7%99%BA%E7%94%9F%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E9%9A%9C%E5%AE%B3%E3%82%92%E8%A7%A3%E6%B1%BA%E3%81%99%E3%82%8B%E3%81%9F%E3%82%81)発生している障害を解決するため

自分の作っている、または既に存在しているシステムにおいて障害が発生した時、**OSSの内部構造を理解していないと解決できない場合**があります。  
ライブラリのソースコードまで踏み込むのは一見遠回りなようですが、**本質的な解決**をすることでエンジニアとしての経験値を得ることができます。

### [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#%E6%A9%9F%E8%83%BD%E5%AE%9F%E8%A3%85%E3%81%AE%E3%81%9F%E3%82%81)機能実装のため

ソースコードにおける既存の機能を学習することで、自身のプロジェクトに実装する際の参考にします。  
例えば、Reactによる先人のソースコードを読むことで、フロントエンド開発に関して自分の中のベストプラクティスを定めることができるでしょう。

### [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#%E6%8A%80%E8%A1%93%E3%81%AE%E3%82%AD%E3%83%A3%E3%83%83%E3%83%81%E3%82%A2%E3%83%83%E3%83%97%E3%81%AE%E3%81%9F%E3%82%81)技術のキャッチアップのため

技術トレンドをキャッチアップするために、先進的なプロジェクトのコードを読むことがあります。  
例えばEthereumのソースコードを読み、ブロックチェーン技術について理解を深める、などです。

### [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E8%A8%80%E8%AA%9E%E5%AD%A6%E7%BF%92%E3%81%AE%E3%81%9F%E3%82%81)プログラミング言語学習のため

学習したいプログラミング言語の理解を深める際に有効です。  
ある程度文法が理解できている言語であれば、**実際にソフトウェアでどのように使われているか**を学習することができます。

## [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#%E4%BD%95%E3%82%92%E8%AA%AD%E3%82%81%E3%81%B0%E3%81%84%E3%81%84%E3%81%AE%E3%81%8B)何を読めばいいのか

業務上読むべきものが決まっている場合はそれを読むとよいでしょう。  
そうでない場合は、

**・ある程度習熟している言語**  
**・実際に使っていたり、仕様を把握しているもの**  
**・新しい技術で、知的好奇心がくすぐられているもの**

など先ほど例に挙げたような目的別に、自分なりに選定しましょう。  
もし馴染みのないOSSの場合は、一度自分で動かしてみたり使ってみることをおすすめします。

ここで、githubで自分の読みたい言語を指定して検索する方法を紹介します。  
[![Repository search results · GitHub - Google Chrome 2023_09_16 14_42_47.png](Clippings/assets/OSSコードリーディングのすゝめ%20-%20Qiita-2024-09-19%2019-15-42/Repository%20search%20results%20·%20GitHub%20-%20Google%20Chrome%202023_09_16%2014_42_47.png)](https://camo.qiitausercontent.com/5d01f3e51abad0502417cc5afb27ff989b242f4e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f323734303536302f37383039363762342d366363392d653634352d346437322d6435306465343530396637642e706e67)  
とは言っても、検索バーで`language:<言語>`と入力するだけです。  
他にも、  
`filename:`でファイル名を指定したり、  
`path:`でパスを指定することもできます。

## [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#%E6%B0%97%E3%82%92%E4%BB%98%E3%81%91%E3%82%8B%E3%81%B9%E3%81%8D%E3%81%93%E3%81%A8)気を付けるべきこと

### [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#%E5%85%A8%E4%BD%93%E3%82%92%E8%AA%AD%E3%82%82%E3%81%86%E3%81%A8%E3%81%97%E3%81%AA%E3%81%84)全体を読もうとしない。

OSSコードリーディングにおける初見殺しと呼べる行動が、  
**巨大なソースコードを一から読もうとすること**です。

Linuxなど超有名どころのソースコードは、  
自力でコードを一から読み始めても一生全体を理解することはできないでしょう。

途中で挫折して、自分がどの部分を理解したのかさえ分からないというのがオチです。

小規模なソフトウェアの全容を把握したいときはいいかもしれませんが、  
どのみちいきなりコードを読み始めるのではなく、**自分が全体の中のどの部分を読もうとしているのか**を把握しましょう。

### [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#%E7%9B%AE%E7%9A%84%E3%82%92%E8%A6%8B%E5%A4%B1%E3%82%8F%E3%81%AA%E3%81%84)目的を見失わない

とにかく自分が何のためにコードを理解したいのかを忘れないようにしましょう。  
OSSコードリーディングに限ったことではありませんが、  
**忍耐力が必要な作業には目的意識が必要**です。

読んだ先に何があるのか、何を得ることができるのかを明確にし、  
**飽きてきたとしても作業を続けることができる動機を作る**ことが重要です。

せっかくであれば後から振り返って意味のない行動にならないようにしたいですね。

## [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#oss%E3%82%B3%E3%83%BC%E3%83%89%E3%83%AA%E3%83%BC%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%AE%E6%89%8B%E6%B3%95)OSSコードリーディングの手法

### [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#%E3%82%B3%E3%83%BC%E3%83%89%E3%83%AA%E3%83%BC%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%AE%E3%81%9F%E3%82%81%E3%81%AE%E7%92%B0%E5%A2%83)コードリーディングのための環境

github上で読んでいくのが手軽かつ構造的に見ることができるのでいいでしょう。

ただ開発や保守で必要な場合など、本格的に細部の挙動まで把握しておくべき場合は普段自分が使っているエディタを用いるのがよいと思います。

検索やコードジャンプ機能がある、VScodeなどが便利です。

### [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#%E7%9B%AE%E7%9A%84%E3%82%92%E6%B1%BA%E3%82%81%E3%82%8B)目的を決める

先ほども述べたように何のためにコードリーディングを始めるのか、どのような状態になりたいのかは明確にしておきましょう。

### [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#%E3%83%89%E3%82%AD%E3%83%A5%E3%83%A1%E3%83%B3%E3%83%88%E3%82%92%E8%AA%AD%E3%82%80)ドキュメントを読む

ドキュメントが充実している場合、目的によってはそもそもソースコードを読む必要もないかもしれません。  
関数の説明や、コンポーネントごとの役割の説明などをしてくれている場合が多いのでまずは目を通してみることをおすすめします。

### [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#qa%E3%82%B5%E3%82%A4%E3%83%88%E3%82%92%E7%A2%BA%E8%AA%8D%E3%81%99%E3%82%8B)QAサイトを確認する

コミュニティサイトやチャットで、開発者が質問に対して答えている場合があります。  
自分の気になっている部分が既存の疑問の場合、それを読むことで解決できる場合があります。  
githubやslack, google groupなどが使われることが多いようです。

### [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#%E5%85%A8%E4%BD%93%E5%83%8F%E3%82%92%E6%8A%8A%E6%8F%A1%E3%81%99%E3%82%8B)全体像を把握する

アーキテクチャや主要なコンポーネントを把握しておくと、調べたい機能がどのあたりに属するのか見当がつきやすいです。  
ここに関してはいくつか方法があります。  
・ドキュメントを読んで把握する。  
・ChatGPTに聞いてみる。  
・自らの経験と勘で、フォルダ構成から把握する。  
自分のレベルごとに全体像を把握するための方法を考えましょう。

以下はPyTorchのソースコードに関して、ChatGPTに質問した例です。  
[![torch全体像.png](Clippings/assets/OSSコードリーディングのすゝめ%20-%20Qiita-2024-09-19%2019-15-42/torch全体像.png)](https://camo.qiitausercontent.com/c2f33db8198215606101d553a2e7785d23d846ab/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f323734303536302f39623164646538622d663039382d396539342d376133312d3738353636383762323035362e706e67)  
PyTorchに関してあまり知らない人でも、`torch/nn`らへんを見ればニューラルネットワークモジュールとその周辺が記述されているんだなということが分かりそうですね。

### [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#%E9%87%8D%E7%82%B9%E7%9A%84%E3%81%AB%E8%AA%AD%E3%82%80%E9%83%A8%E5%88%86%E3%82%92%E6%B1%BA%E3%82%81%E3%82%8B)重点的に読む部分を決める

先ほども注意点としてあげたように、いきなり全体を読もうとするのは危険です。  
全体像を把握した上で、自分の目的と持っている時間的なリソースとの兼ね合いで何を重点的に読むのかを明確にしましょう。

ここまで来たら、あとは自信をもってどんどん読み進めるのみです！

### [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#%E3%82%B3%E3%83%9F%E3%83%83%E3%83%88%E3%83%AD%E3%82%B0%E3%83%97%E3%83%AB%E3%83%AA%E3%82%AF%E3%82%A8%E3%82%B9%E3%83%88%E3%82%92%E8%A6%8B%E3%81%A6%E3%81%BF%E3%82%8B)コミットログ・プルリクエストを見てみる

余裕があれば、コミットログやプルリクエストを見てみると勉強になります。  
どのような経緯で実装したのか、なぜ変更が必要だったのか、を考えることでエンジニアとしての経験を自分のものにすることができます。

### [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#%E8%AA%AD%E3%82%93%E3%81%A7%E3%82%82%E5%88%86%E3%81%8B%E3%82%89%E3%81%AA%E3%81%84%E6%99%82%E3%81%AF%E5%AE%9F%E9%9A%9B%E3%81%AB%E5%8B%95%E3%81%8B%E3%81%99)読んでも分からない時は実際に動かす

OSSに限らず、最も自分の身になる勉強法は自分で動かすことです。  
ソースコードの一部分を自分のエディタ上で動かせるような環境を整え、積極的に実行するとよいでしょう。

### [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#%E3%82%A2%E3%82%A6%E3%83%88%E3%83%97%E3%83%83%E3%83%88%E3%81%99%E3%82%8B)アウトプットする

言わずもがなですが、アウトプットすることで理解度・定着度が圧倒的に高くなります。  
・個人ブログ  
・社内wiki  
・スライド+登壇  
など手軽なものでもアウトプットすることで自分のレベルをどんどん上げていくことが可能です。

## [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#oss%E3%82%B3%E3%83%BC%E3%83%89%E3%83%AA%E3%83%BC%E3%83%87%E3%82%A3%E3%83%B3%E3%82%B0%E3%81%AE%E5%AE%9F%E8%B7%B5)OSSコードリーディングの実践

今回紹介した流れを基に、OSSコードリーディングを実践してみました。  
Lightningのソースコードについて読んでいきたいと思います。

Lightningとは、PyTorchのコードを簡略化して書くことができるようになるライブラリです。  
研究者がエンジニアリングに力を入れなくても機械学習を用いられるようにすることを目的としています。

以下が公式ドキュメントです。

目的としては、`pytorch_lightning.LightningModule`の仕組みをある程度理解することとします。  
`pytorch_lightning`モジュールに含まれる、`LightningModule`のソースコードを探し出し、理解していきたいと思います。

まずはドキュメントやQAサイトを読んでみます。機能の説明はしてくれていますが、実際のソースコードについては触れられていないため、ソースコードを読んでいくことにします。

[![Welcome to ⚡ PyTorch Lightning — PyTorch Lightning 2.0.9 documentation - Google Chrome 2023_09_19 18_26_55.png](Clippings/assets/OSSコードリーディングのすゝめ%20-%20Qiita-2024-09-19%2019-15-42/Welcome%20to%20⚡%20PyTorch%20Lightning%20—%20PyTorch%20Lightning%202.0.9%20documentation%20-%20Google%20Chrome%202023_09_19%2018_26_55.png)](https://camo.qiitausercontent.com/2873f24fb52d8270573019ab717c821a93231d05/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f323734303536302f33396661393335362d616336342d323939642d643966362d6535303866613162656265342e706e67)

ドキュメント内にソースコードが記述されているgithubリポジトリへのリンクがあったのでそこへ飛びます。

[![github.png](Clippings/assets/OSSコードリーディングのすゝめ%20-%20Qiita-2024-09-19%2019-15-42/github.png)](https://camo.qiitausercontent.com/398e12f764f00669b8ed1fe420d775deaeb6828c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f323734303536302f62363361393030382d303464662d663934612d343736382d6339643161396664636131392e706e67)

全体像を把握するために、一通り各フォルダの中身を眺めてみました。  
以下の`src/lightning/pytorch`ディレクトリにpytorch lightningについて記述されているようでした。

またChatGPTにも、各フォルダがどのような役割をしているのかを簡単に聞いてみました。

[![lightningフォルダ構成.png](Clippings/assets/OSSコードリーディングのすゝめ%20-%20Qiita-2024-09-19%2019-15-42/lightningフォルダ構成.png)](https://camo.qiitausercontent.com/9c8a20d28d285254a5360ad2e0a7b9a35928983a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f323734303536302f61383235613966372d353462382d666464652d303764342d3031393539323566346235632e706e67)

出力にもある通りChatGPTの内容は2022年1月時点の内容であるためディレクトリの構成は若干違いますが、各フォルダの役割に関してある程度全体像を掴むことができました。

ある程度全体像を掴むことができたので、`LigtningModule`について読んでいきます。

一旦「LightningModule」でリポジトリ内を検索してみます。  
早速、`LightningModule`について記述されていそうな場所を見つけました。

[![Code search results - Google Chrome 2023_09_20 15_47_31.png](Clippings/assets/OSSコードリーディングのすゝめ%20-%20Qiita-2024-09-19%2019-15-42/Code%20search%20results%20-%20Google%20Chrome%202023_09_20%2015_47_31.png)](https://camo.qiitausercontent.com/f16e7ff64de9100443db62e35164f3bd401445ae/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f323734303536302f36663063653339372d623961322d326335302d376236612d6166326363336264383461332e706e67)

この`LightningModule`の仕組みを把握するために、中身を読んでいきます。

まずは全体をざっと眺めます。  
親となるクラスが複数存在し、関数やクラスメソッド、オーバーロードが多く記述されています。

github上では、クラス内にどのような関数や変数が記述されているのかを構造的に書いてくれています。  
[![5github_func.png](Clippings/assets/OSSコードリーディングのすゝめ%20-%20Qiita-2024-09-19%2019-15-42/5github_func.png)](https://camo.qiitausercontent.com/08da516e9d187989e80a69f7e219ddbf235ce36e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f323734303536302f36313037346632642d373362312d383761302d396336302d3034373963666363326464362e706e67)  
これは全体像を把握する上では大変便利です。

次に、自分が仕組みを把握するために重点的に読む部分を決めました。  
具体的には、

・元となるクラスの構造  
・自分も使う、主要な関数の仕組み  
・気になる関数の役割

を読みました。  
深く読もうと思えばもっと深く読むこともできますが、ここは自分の持つ時間と目的との兼ね合いで考えましょう。

まずは元となるクラスの構造とその役割を見ていきました。  
元となるクラスは5つあることが分かります。  
それぞれについてリポジトリ上で検索をして、記述されている場所を探しました。

以下は１つめの親クラスに関しての記述です。  
[![hyper.png](Clippings/assets/OSSコードリーディングのすゝめ%20-%20Qiita-2024-09-19%2019-15-42/hyper.png)](https://camo.qiitausercontent.com/888a9eb44a94741a259e6282685139f9caf26ea6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f323734303536302f32313064633461372d386630362d356130352d306661382d3261313035666130616334622e706e67)

この時、親クラスの呼び出し順について復習するために、自分でコードを書いて実行をするなどをしました。

myclass.py

```
class BaseClass:
    def __init__(self):
        super().__init__()
        print("BaseClass init")
        super().__init__()

class SecondClass:
    def __init__(self):
        print("Second init")
        super().__init__()

class ThirdClass:
    def __init__(self):
        print("Third init")

class MyClass(BaseClass, SecondClass, ThirdClass):
    def __init__(self):
        super().__init__()
        print("MyClass init")

myclass = MyClass()
```

```
Second init
Third init
BaseClass init
Second init
Third init
MyClass init
```

`super().__init__`によって次に記述されている親クラスのコンストラクタが呼び出されることが確認できました。

次の親クラスである`ModelHooks`, `DataHooks`, `CheckpointHooks`は同じファイル内に記述してありました。  
こちらもそれぞれ読んである程度の役割を把握しました。

残るはModuleクラスです。Moduleクラスに関しては、

module.py

```
from torch.nn import Module
```

でインポートされているため、lightningではなくpytorchに記述されているクラスのようです。  
今回の目的とは少し逸れますが、この`Module`クラスの場所も探したいと思います。

pytorchのリポジトリ

を眺め、それぞれのフォルダの中身を見てみましたがどこに記述されていそうか見当がつきませんでした。  
リポジトリ内を検索をしても様々なmoduleという単語がヒットしてしまい見つかりそうにありません。  
そこで、今回はChatGPTに聞いてみることにしました。  
[![moduleの場所.png](Clippings/assets/OSSコードリーディングのすゝめ%20-%20Qiita-2024-09-19%2019-15-42/moduleの場所.png)](https://camo.qiitausercontent.com/db439ce03b44a1bdecaec289e05b5edb6febd879/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f323734303536302f64336538386231362d346537642d336433342d353039312d6630363330643966356437612e706e67)  
今回の場合は一発でそのファイルへのリンクを出力してくれました。  
以下がそのリンクです。

Moduleクラスが記述されていることが分かります。  
Moduleクラスに関しては今回の目的に対して重要ではないので、眺める程度にとどめました。

## [](https://qiita.com/nemo_Nuco/items/5c37eea3663068d6fd65#%E3%81%BE%E3%81%A8%E3%82%81)まとめ

今回はOSSを題材に、コードリーディングのに関する進め方、気を付けた方がよいことをまとめました。  
これらを意識するだけで効率の良いキャッチアップを行うことができると思いますので、ぜひご活用ください！

弊社Nucoでは、他にも様々なお役立ち記事を公開しています。よかったら、Organizationのページも覗いてみてください。  
また、Nucoでは一緒に働く仲間も募集しています！興味をお持ちいただける方は、[こちら](https://www.recruit.nuco.co.jp/?qiita_item_id=5c37eea3663068d6fd65)まで。
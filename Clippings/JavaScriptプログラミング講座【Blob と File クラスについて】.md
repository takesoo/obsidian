---
URL: https://hakuhin.jp/js/file.html
---
## Blob と File クラスについて

Blob オブジェクトは、「コンテンツタイプ情報」と「バッファ情報」の２つを内包する事ができます。 １つの仮想的なファイル（小塊）として取り扱う事ができます。

### ■ブラウザが File クラスをサポートしているか調べる

### ■ローカルファイルの中身に読み取りアクセスする

### ■ローカルファイルをリソースとして活用する

```
// ------------------------------------------------------------// Blob オブジェクトを作成（中身が空）// ------------------------------------------------------------var blob = new Blob();// 出力テストconsole.log(blob);console.log("type:" + (blob.type)); // ""console.log("size:" + (blob.size)); // 0
```

```
// ------------------------------------------------------------// 適当なバッファを用意// ------------------------------------------------------------var str = "文字列テスト";var source = [ str ];// ------------------------------------------------------------// BlobPropertyBag オブジェクトを用意// ------------------------------------------------------------var blob_property_bag = {	type: "text/plain"};// ------------------------------------------------------------// Blob オブジェクトを作成（UTF-8 形式のプレーンテキスト）// ------------------------------------------------------------var blob = new Blob( source , blob_property_bag );// 出力テストconsole.log("type:" + (blob.type)); // "text/plain"console.log("size:" + (blob.size)); // 18// ------------------------------------------------------------// FileReader オブジェクトを生成// ------------------------------------------------------------var file_reader = new FileReader();// ------------------------------------------------------------// 読み込み完了時に実行されるイベント（成功失敗に関係なく）// ------------------------------------------------------------file_reader.onloadend = function(e){	// エラー	if(file_reader.error) return;	// 出力テスト	console.log(file_reader.result); // "文字列テスト"};// ------------------------------------------------------------// 読み込みを開始する（テキスト文字列を得る）// ------------------------------------------------------------file_reader.readAsText(blob);
```

```
// ------------------------------------------------------------// 適当なバッファを用意// ------------------------------------------------------------var ary_u8 = new Uint8Array([0x00,0x01,0x02,0x03]);var source = [ ary_u8 ];// ------------------------------------------------------------// BlobPropertyBag オブジェクトを用意// ------------------------------------------------------------var blob_property_bag = {	type: "application/octet-stream"};// ------------------------------------------------------------// Blob オブジェクトを作成（バイナリ形式）// ------------------------------------------------------------var blob = new Blob( source , blob_property_bag );// 出力テストconsole.log("type:" + (blob.type)); // "application/octet-stream"console.log("size:" + (blob.size)); // 4// ------------------------------------------------------------// FileReader オブジェクトを生成// ------------------------------------------------------------var file_reader = new FileReader();// ------------------------------------------------------------// 読み込み完了時に実行されるイベント（成功失敗に関係なく）// ------------------------------------------------------------file_reader.onloadend = function(e){	// エラー	if(file_reader.error) return;	// Uint8Array オブジェクトを作成する	var ary_u8 = new Uint8Array(file_reader.result);	// 出力テスト	console.log(ary_u8); // [0x00,0x01,0x02,0x03]};// ------------------------------------------------------------// 読み込みを開始する（ArrayBuffer オブジェクトを得る）// ------------------------------------------------------------file_reader.readAsArrayBuffer(blob);
```

```
// ------------------------------------------------------------// 複数の適当なバッファを用意// ------------------------------------------------------------var ary_u8_a = new Uint8Array([0x00,0x01,0x02,0x03]);var ary_u8_b = new Uint8Array([0x04,0x05,0x06]);var ary_u8_c = new Uint8Array([0x07,0x08]);var source = [ ary_u8_a , ary_u8_b , ary_u8_c ];// ------------------------------------------------------------// BlobPropertyBag オブジェクトを用意// ------------------------------------------------------------var blob_property_bag = {	type: "application/octet-stream"};// ------------------------------------------------------------// Blob オブジェクトを作成（バイナリ形式）// ------------------------------------------------------------var blob = new Blob( source , blob_property_bag );// 出力テストconsole.log("type:" + (blob.type)); // "application/octet-stream"console.log("size:" + (blob.size)); // 9// ------------------------------------------------------------// FileReader オブジェクトを生成// ------------------------------------------------------------var file_reader = new FileReader();// ------------------------------------------------------------// 読み込み完了時に実行されるイベント（成功失敗に関係なく）// ------------------------------------------------------------file_reader.onloadend = function(e){	// エラー	if(file_reader.error) return;	// Uint8Array オブジェクトを作成する	var ary_u8 = new Uint8Array(file_reader.result);	// 出力テスト	console.log(ary_u8); // [0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08]};// ------------------------------------------------------------// 読み込みを開始する（ArrayBuffer オブジェクトを得る）// ------------------------------------------------------------file_reader.readAsArrayBuffer(blob);
```

## File オブジェクトを作成する

### ■ File オブジェクトの作成について

```
// ------------------------------------------------------------// 適当なバッファを用意// ------------------------------------------------------------var str = "文字列テスト";var source = [ str ];// ------------------------------------------------------------// FilePropertyBag オブジェクトを用意// ------------------------------------------------------------var file_property_bag = {	// コンテンツタイプを設定	type: "text/plain",	// 最終更新日時を設定（単位：ミリ秒）	lastModified: 0};// ------------------------------------------------------------// File オブジェクトを作成（UTF-8 形式のプレーンテキスト）// ------------------------------------------------------------var file = new File( source , "test.txt" , file_property_bag );// 出力テストconsole.log("name:" + (file.name)); // "test.txt"console.log("type:" + (file.type)); // "text/plain"console.log("size:" + (file.size)); // 18// ------------------------------------------------------------// FileReader オブジェクトを生成// ------------------------------------------------------------var file_reader = new FileReader();// ------------------------------------------------------------// 読み込み完了時に実行されるイベント（成功失敗に関係なく）// ------------------------------------------------------------file_reader.onloadend = function(e){	// エラー	if(file_reader.error) return;	// 出力テスト	console.log(file_reader.result); // "文字列テスト"};// ------------------------------------------------------------// 読み込みを開始する（テキスト文字列を得る）// ------------------------------------------------------------file_reader.readAsText(file);
```

```
// ------------------------------------------------------------// 適当なバッファを用意// ------------------------------------------------------------var ary_u8 = new Uint8Array([0x00,0x01,0x02,0x03]);var source = [ ary_u8 ];// ------------------------------------------------------------// FilePropertyBag オブジェクトを用意// ------------------------------------------------------------var file_property_bag = {	// コンテンツタイプを設定	type: "application/octet-stream",	// 最終更新日時を設定（単位：ミリ秒）	lastModified: 0};// ------------------------------------------------------------// File オブジェクトを作成（バイナリ形式）// ------------------------------------------------------------var file = new File( source , "text.dat" , file_property_bag );// 出力テストconsole.log("name:" + (file.name)); // "test.dat"console.log("type:" + (file.type)); // "application/octet-stream"console.log("size:" + (file.size)); // 4// ------------------------------------------------------------// FileReader オブジェクトを生成// ------------------------------------------------------------var file_reader = new FileReader();// ------------------------------------------------------------// 読み込み完了時に実行されるイベント（成功失敗に関係なく）// ------------------------------------------------------------file_reader.onloadend = function(e){	// エラー	if(file_reader.error) return;	// Uint8Array オブジェクトを作成する	var ary_u8 = new Uint8Array(file_reader.result);	// 出力テスト	console.log(ary_u8); // [0x00,0x01,0x02,0x03]};// ------------------------------------------------------------// 読み込みを開始する（ArrayBuffer オブジェクトを得る）// ------------------------------------------------------------file_reader.readAsArrayBuffer(file);
```

```
// ------------------------------------------------------------// 複数の適当なバッファを用意// ------------------------------------------------------------var ary_u8_a = new Uint8Array([0x00,0x01,0x02,0x03]);var ary_u8_b = new Uint8Array([0x04,0x05,0x06]);var ary_u8_c = new Uint8Array([0x07,0x08]);var source = [ ary_u8_a , ary_u8_b , ary_u8_c ];// ------------------------------------------------------------// FilePropertyBag オブジェクトを用意// ------------------------------------------------------------var file_property_bag = {	// コンテンツタイプを設定	type: "application/octet-stream",	// 最終更新日時を設定（単位：ミリ秒）	lastModified: 0};// ------------------------------------------------------------// File オブジェクトを作成（バイナリ形式）// ------------------------------------------------------------var file = new File( source , "test.dat" , file_property_bag );// 出力テストconsole.log("name:" + (file.name)); // "test.dat"console.log("type:" + (file.type)); // "application/octet-stream"console.log("size:" + (file.size)); // 9// ------------------------------------------------------------// FileReader オブジェクトを生成// ------------------------------------------------------------var file_reader = new FileReader();// ------------------------------------------------------------// 読み込み完了時に実行されるイベント（成功失敗に関係なく）// ------------------------------------------------------------file_reader.onloadend = function(e){	// エラー	if(file_reader.error) return;	// Uint8Array オブジェクトを作成する	var ary_u8 = new Uint8Array(file_reader.result);	// 出力テスト	console.log(ary_u8); // [0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08]};// ------------------------------------------------------------// 読み込みを開始する（ArrayBuffer オブジェクトを得る）// ------------------------------------------------------------file_reader.readAsArrayBuffer(file);
```

### ■バッファの開始と終了位置を指定して、新しい Blob オブジェクトを生成する

```
// ------------------------------------------------------------// Blob オブジェクトを複製する関数// ------------------------------------------------------------function BlobClone(blob){	return blob.slice(0 , blob.size , blob.type);}// ------------------------------------------------------------// 適当なバッファを用意// ------------------------------------------------------------var ary_u8 = new Uint8Array([0x00,0x01,0x02,0x03]);var source = [ ary_u8 ];// ------------------------------------------------------------// BlobPropertyBag オブジェクトを用意// ------------------------------------------------------------var blob_property_bag = {	type: "application/octet-stream"};// ------------------------------------------------------------// Blob オブジェクトを作成（バイナリ形式）// ------------------------------------------------------------var blob_a = new Blob( source , blob_property_bag );// ------------------------------------------------------------// Blob オブジェクトを複製// ------------------------------------------------------------var blob_b = BlobClone(blob_a);// 出力テストconsole.log("type:" + (blob_b.type)); // "application/octet-stream"console.log("size:" + (blob_b.size)); // 4// ------------------------------------------------------------// FileReader オブジェクトを生成// ------------------------------------------------------------var file_reader = new FileReader();// ------------------------------------------------------------// 読み込み完了時に実行されるイベント（成功失敗に関係なく）// ------------------------------------------------------------file_reader.onloadend = function(e){	// エラー	if(file_reader.error) return;	// Uint8Array オブジェクトを作成する	var ary_u8 = new Uint8Array(file_reader.result);	// 出力テスト	console.log(ary_u8); // [0x00,0x01,0x02,0x03]};// ------------------------------------------------------------// 読み込みを開始する（ArrayBuffer オブジェクトを得る）// ------------------------------------------------------------file_reader.readAsArrayBuffer(blob_b);
```

```
// ------------------------------------------------------------// 適当なバッファを用意// ------------------------------------------------------------var str = "あいうえお";var source = [ str ];// ------------------------------------------------------------// BlobPropertyBag オブジェクトを用意// ------------------------------------------------------------var blob_property_bag = {	type: "text/plain"};// ------------------------------------------------------------// Blob オブジェクトを作成（UTF-8 形式のプレーンテキスト）// ------------------------------------------------------------var blob_a = new Blob( source , blob_property_bag );// ------------------------------------------------------------// 開始と終了位置を指定して、新しい Blob オブジェクトを作成// ------------------------------------------------------------var blob_b = blob_a.slice(3 , 9);// ------------------------------------------------------------// FileReader オブジェクトを生成// ------------------------------------------------------------var file_reader = new FileReader();// ------------------------------------------------------------// 読み込み完了時に実行されるイベント（成功失敗に関係なく）// ------------------------------------------------------------file_reader.onloadend = function(e){	// エラー	if(file_reader.error) return;	// Uint8Array オブジェクトを作成する	var ary_u8 = new Uint8Array(file_reader.result);	// 出力テスト	console.log(ary_u8); // [ 0xE3,0x81,0x84 , 0xE3,0x81,0x86 ] (い,う)};// ------------------------------------------------------------// 読み込みを開始する（ArrayBuffer オブジェクトを得る）// ------------------------------------------------------------file_reader.readAsArrayBuffer(blob_b);
```
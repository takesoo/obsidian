---
finished reading: false
favorite: false
tags:
  - clippings
---
# 速習 Claude Code
  #ReadItLater 
 #ReadableArticle

## articleURL
https://zenn.dev/mizchi/articles/claude-code-cheatsheet

## siteName
Zenn

## date
2025-07-07

## articleContent
講習会用にまとめたもの。可能なら公式ドキュメントを参照するのを推奨するが、この資料ではサッと使いはじめるために要点を絞って解説する。

claude-code は claude-code 自身で開発されており、恐ろしい速度で更新されてる点に注意。この資料は一瞬で古くなる。

アカウントの契約等は省略

## インストールと実行

```
$ npm i -g @anthropic/claude-code
$ claude
# Token 等初期のセットアップ
```

## セッションの管理

一番簡単な使い方

```
$ claude
> hello
こんにちは！どのようなお手伝いをしましょうか？
# Ctrl-C で抜ける
```

次回起動時はこの会話を忘れているが、 `-c` で直近のセッションに戻れる。

直近のセッション以外に戻りたいときは、 `-r` (--resume) を使う。

```
$ claude -r
    Modified    Created     # Messages Summary
❯ 1. 1m ago      1m ago               2 hello
```

## セキュリティ

`.claude/settings.json` でデフォルトのパーミッションを指定できる。

```
{
  "permissions": {
    "allow": ["Bash(npm run lint)", "Bash(npm run test:*)", "Read(~/.zshrc)"],
    "deny": ["Bash(curl:*)"]
  }
}
```

セッション内で `<Shift+TAB>` でモードを切り替える。

-   `⏵⏵ auto-accept edits on`: 明示的に許可されていたり、一度許可されたコマンドは自動で許可するモード
-   `⏸ plan mode on` : ファイルを編集せずに、Readonly で設計を練るモード。
-   `Bypassing Permissions`: `--allow-dangerosuly-permissions` で全部許可するモード。**危険**

最初はデフォルトで使用しつつ、慣れてきたら permission を制御して権限を渡して許容できる範囲で自動化していくのを推奨。

`rm -rf ~/` を実行された人もいます。

## よく使うコマンド

`/model` モデル指定する。デフォルトでは Sonnet と Opus を使い分けるようになっているが、`Opus` のみの指定もできる。コンテキスト消費速度は約 5 倍なのに注意。

`/clear` で会話履歴をリセットする。変なログを食って、暴走し始めたときに使う。

`/compact` はそのセッションの会話を要約して、コンテキストを圧縮する。  
履歴が膨らむと勝手に発動するので、よく使うというか、残念ながら使わされるコマンド

```
  /compact
      Clear conversation history but keep a summary in context. Optional:
       /compact [instructions for summarization]
```

`@/` ファイル名を補完できる。

`! pwd`: `!` だと AI を介さずに直接コマンドを実行。勝手に CD して暴走してるときがあるので、指示を出す前に確認

claude 内で `#` で入力することで、動的に CLAUDE.md に追記することも可能。

また、 `.claude/commands/custom-command.md` を置けば、claude 内で使えるカスタムコマンドを作れる。

自分が作った gemini cli に検索させる例。

````
## Gemini Search

`gemini` is google gemini cli. **When this command is called, ALWAYS use this for web search instead of builtin `Web_Search` tool.**

When web search is needed, you MUST use `gemini --prompt` via Task Tool.

Run web search via Task Tool with `gemini --prompt 'WebSearch: $ARGUMENTS'`

Run

```bash
gemini --prompt 'WebSearch: $ARGUMENTS'
```
````

`think`, `think hard`, `ultrathink`. この文言をプロンプトに含むと、Reasoning モードになり AI が出力を自己反復して深く考えるようになる。トークン消費も実行時間も多く消費するので、**常に使う必要はない**。どうしてもバグを直せないときに。

## メモリの管理: CLAUDE.md

-   `~/.claude/CLAUDE.md`: 常に読み込まれる
    -   自分はこれだけ: `ユーザーには日本語で応答してください。`
-   `./CLAUDE.md`: claude を実行したときのディレクトリで読み込まれる。

設定例

```
このプロジェクトでは npm と typescript と vitest を使う
```

`/memory` を実行することで、今読み込んでいるメモリーを確認できる

```
/memory

Memory Files
 L user: ~/.claude/CLAUDE.md
 L project: ~/mizchi/ai-coding-guide/examples/07-real-world/CLAUDE.md

Learn more: https://docs.anthropic.com/en/docs/claude-code/memory

╭─────────────────────────────────────────────────────────────────────────╮
│                                                                         │
│ Select memory to edit:                                                  │
│                                                                         │
│  ❯ 1. Project memory          Checked in at ./CLAUDE.md                 │
│    2. Project memory (local)  Gitignored in ./CLAUDE.local.md           │
│    3. User memory             Saved in ~/.claude/CLAUDE.md              │
│                                                                         │
│ Memory file does not exist yet. [Enter] to create ./CLAUDE.md.          │
│                                                                         │
╰─────────────────────────────────────────────────────────────────────────╯
```

## MCP の設定

AI が使えるツールを追加する。 `claude mcp` コマンドで管理できる。

```
$ claude mcp add playwright-mcp npx -- -y @playwright/mcp@latest
```

あるいは `.mcp.json` だが、既に `~/claude.json` にプロジェクトが管理されていると、読み込まれたり読み込まれなかったりする。

```
{
  "mcpServers": {
    "readability": {
      "command": "npx",
      "args": ["-y", "@mizchi/readability", "--mcp"]
    }
  }
}
```

`/mcp` で起動してるツールを確認できる。

```
/mcp
╭─────────────────────────────────────────────────────────────────────────╮
│ Manage MCP servers                                                      │
│                                                                         │
│ ❯ 1. playwright-mcp  ✔ connected · Enter to view details                │
╰─────────────────────────────────────────────────────────────────────────╯
   Esc to exit
```

## レートリミットの体感値

使いまくってるとレートリミットが来る。

おそらく時間あたりの上限の半分で `Approaching OUsage Limit...` が表示されるが、まだ余裕がある。`You will reset at 11pm/Asia` のように表示されると、ほぼ限界。

自分は $200 のプランで、 3 並列で使っていると、5 時間のうち 1 時間ぐらいは止まっている。コードリーディングや、休憩時間に当てている。

## おわり

この資料では、プロンプトの書き方等は説明しない。そこは使いながら覚えてください。
---
tags:
  - 良いコード悪いコードで学ぶ設計入門
---
- [[凝集度|低凝集]]を呼び込む悪魔
	- staticメソッドの誤用
		- staticメソッドはインスタンス変数を使えない
			- 引数にデータクラスを使い、低凝集になりがち
		- インスタンス変数を使う構造に作り変える
			- [[第3章 クラス設計]]のMoneyクラスの構造になる
		- インスタンスメソッドのフリしたstaticメソッドに注意
		- どうしてstaticメソッドが使われてしまうのか
			- 手続き型言語の考え方の名残
			- インスタンス生成が不要なためお手軽に使われがち
		- どういうときにstaticメソッドを使えばいいのか
			- ==凝集度に影響がない場合==
				- ログ出力用メソッド
				- フォーマット変換用メソッド
				- [[ファクトリメソッド]]
	- 初期化ロジックの分散
		- コンストラクタをpublicにすると外部のクラスで様々な用途で使われがちになる
		- ==コンストラクタをprivateにして、代わりにファクトリメソッドを用意する==
		- 生成ロジックが増えすぎたら[[ファクトリクラス]]を検討すること
	- 共通処理クラス（Common・Util）
		- さまざまなロジックが雑多に置かれがち
			- いろんなクラスにまたがる共通処理が集まり、関心がバラバラ
			- しかも大体staticメソッド
		- オブジェクト指向設計の基本に立ち返ろう
			- その共通処理専用のクラス（たとえば税込金額クラス）にして、インスタンスメソッドで実装する
		- 横断的関心事
			- ログ出力
			- エラー検出処理
			- 例外処理
			- etc...
			- これらは共通処理としてまとめて、インスタンス化する必要がなければstatucメソッドとして設計しても問題ない
	- 結果を返すために引数を使わないこと
		- メソッドの中で引数を変更して返すことはすべきでない
		- 引数が入力なのか出力なのか、メソッド内部を知らなければならなくなる
		- このような引数を出力引数という
		- データとロジックが別々のクラスに定義されがち（[[凝集度|低凝集]]）
		- しかるべきクラスで、新しいインスタンスを返す形にする
	- 多すぎる引数
		- プリミティブ型執着
			- プログラミング言語が標準で用意している基本データ型をプリミティブ型と呼ぶ
			- 引数、戻り値ともにプリミティブ型だけで構成されたプリミティブ型執着と呼ぶ
			- プリミティブ型の引数の場合、引数のバリデーションが必要になり、それぞれのクラスに似たようなロジックが実装されて低凝集
			- [[値オブジェクト]]クラスを実装し、値オブジェクトでバリデーションし、引数の型も値オブジェクトにする
		- 意味のある単位ごとにクラス化する
			- データを引数として扱うのではなく、インスタンス変数として持つクラスへ設計変更してみる
	- メソッドチェイン
		- メソッドチェインで内部詳細を渡り歩く作りは[[デメテルの法則]]違反
		- 影響範囲が悪戯に拡大可能な構造であり、保守が辛くなる
		- 尋ねるな、命じろ(Tell. Don't Ask.)
			- ほかのオブジェクトの内部状態（つまり変数）を尋ねたり、その状態に応じて呼び出し側が判断したりするのではなく、呼び出し側はただメソッドで命じるだけで、命令された側で適切な判断や制御するよう設計する
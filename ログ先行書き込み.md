---
tags:
  - postgresql
aliases:
  - WAL
  - Write Ahead Logging
---
トランザクションログを記録するしくみ、およびそのログのこと。
データベースに対する変更の前に変更内容をログファイルに書き込む。
Postgresの耐久性とデータ整合性の保証を実現するためのコア部分。

処理の流れ
1. データベースの変更がメモリ上のバッファキャッシュ(Shared Buffer)に書き込まれる
2. トランザクションの変更内容がWALバッファに書き込まれる
3. （WALバッファがいっぱいになるとディスク上のWALファイルにフラッシュされる）
4. トランザクションがコミットされるとWALバッファの内容をWALファイルにフラッシュされる（この時点でデータの永続性が保証される）
5. クライアントにコミット完了を通知
6. 定期的にチェックポイントが発生し、バッファキャッシュ内の変更がディスク上のデータファイルに書き込まれる
